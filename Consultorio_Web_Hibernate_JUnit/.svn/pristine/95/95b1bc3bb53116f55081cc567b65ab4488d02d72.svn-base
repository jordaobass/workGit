package modelo.DAO;


import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;

import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.cfg.AnnotationConfiguration;
import org.hibernate.cfg.Configuration;


public class ConnectionFactory {

	/*private static String usuario = "sa";
    private static String senha = "";
    private static String url = "jdbc:h2:tcp://localhost/~/consultorio;AUTO_SERVER=FALSE";//"jdbc:h2:~/consultorio;AUTO_SERVER=FALSE";
    private static String driver = "org.h2.Driver";
	private static ThreadLocal<Connection> local = new ThreadLocal<Connection>();*/
	
	protected static EntityManagerFactory factory;
	protected static EntityManager manager;
	protected static Session session;
	
	public static Session getConnection() {
			
		// Objeto que contém as configurações do hibernate
	    Configuration cfg = new AnnotationConfiguration();
	
	    // Configura o objeto com o conteúdo do hibernate.cfg.xml
	    cfg.configure("/conf/hibernate.cfg.xml");
	
	    // Instância uma SessionFactory
	    SessionFactory sf = cfg.buildSessionFactory();
	
	    // Abre uma sessão com o Hibernate
	    session = sf.openSession();
	    
	    factory = Persistence.createEntityManagerFactory ("consultorio");
	    manager = factory.createEntityManager ();
	   
	    return session;

	    
	    /** RETIRAR O CÓDIGO A PARTIR DAQUI 
	    try { 
			if (local.get() == null || local.get().isClosed()) {
				Class.forName(driver);
				local.set(DriverManager.getConnection(url, usuario, senha));
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		return local.get();*/
	
	}
}




